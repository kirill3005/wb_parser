# README: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ú–æ–¥—É–ª—è –ú–æ–¥–µ–ª–µ–π (`src/models/`)

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–¥—É–ª—è –º–æ–¥–µ–ª–µ–π. –ï–≥–æ —Ü–µ–ª—å ‚Äî –æ–±—ä—è—Å–Ω–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º, –∫–∞–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–µ–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –∏ –∫–∞–∫ –ª–µ–≥–∫–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–æ–≤—ã—Ö.

## 1. üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: "–ö–æ–Ω—Ç—Ä–∞–∫—Ç" —á–µ—Ä–µ–∑ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è ‚Äî **–ø–æ–ª–Ω–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è**. –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è (`train.py`) –Ω–µ –∏–º–µ–µ—Ç –Ω–∏ –º–∞–ª–µ–π—à–µ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ —Ç–æ–º, –∫–∞–∫—É—é –º–æ–¥–µ–ª—å –æ–Ω –æ–±—É—á–∞–µ—Ç ‚Äî LightGBM, CatBoost –∏–ª–∏ –≤–∞—à—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –Ω–µ–π—Ä–æ—Å–µ—Ç—å.

–≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é **–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–≥–æ –ë–∞–∑–æ–≤–æ–≥–æ –ö–ª–∞—Å—Å–∞ (–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)** `ModelInterface`.

### `ModelInterface` (`src/models/base.py`)

–≠—Ç–æ—Ç –∫–ª–∞—Å—Å ‚Äî —ç—Ç–æ "–∫–æ–Ω—Ç—Ä–∞–∫—Ç" –∏–ª–∏ "—Ä–æ–∑–µ—Ç–∫–∞", –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ª—é–±–∞—è –º–æ–¥–µ–ª—å, —á—Ç–æ–±—ã –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–π —Å –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–æ–π.

**–ú–µ—Ç–æ–¥—ã "–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞":**
*   `fit(self, X_train, y_train, **kwargs)`: –û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å. –î–æ–ª–∂–µ–Ω —É–º–µ—Ç—å –ø—Ä–∏–Ω–∏–º–∞—Ç—å `eval_set` –≤ `**kwargs` –¥–ª—è –º–æ–¥–µ–ª–µ–π, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö early stopping.
*   `predict(self, X)`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã (–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è (–¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏).
*   `predict_proba(self, X)`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏) –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è (–¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏). –î–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–ª–∞—Å—Å–∞ `1`.
*   `save(self, filepath)`: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –≤ —Ñ–∞–π–ª.
*   `load(cls, filepath)`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å –∏–∑ —Ñ–∞–π–ª–∞.

–õ—é–±–æ–π –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç `ModelInterface` –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç —ç—Ç–∏ –ø—è—Ç—å –º–µ—Ç–æ–¥–æ–≤, –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤ –Ω–∞—à–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ.

## 2. üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü–∞–ø–æ–∫: –û–¥–Ω–∞ –ú–æ–¥–µ–ª—å ‚Äî –û–¥–∏–Ω –§–∞–π–ª

–ö–∞–∂–¥–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã, –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

```
src/
‚îî‚îÄ‚îÄ models/
    ‚îú‚îÄ‚îÄ __init__.py   # "–†–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä" –º–æ–¥–µ–ª–µ–π
    ‚îú‚îÄ‚îÄ base.py       # "–ö–æ–Ω—Ç—Ä–∞–∫—Ç" ModelInterface
    ‚îú‚îÄ‚îÄ lgbm.py       # –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è LightGBM
    ‚îú‚îÄ‚îÄ xgb.py        # –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è XGBoost
    ‚îú‚îÄ‚îÄ catboost.py   # –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è CatBoost
    ‚îî‚îÄ‚îÄ sklearn_model.py # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –º–æ–¥–µ–ª–µ–π Scikit-learn
```

### –ö–ª–∞—Å—Å—ã-–û–±–µ—Ä—Ç–∫–∏ (Wrappers)

–§–∞–π–ª—ã `lgbm.py`, `xgb.py` –∏ —Ç.–¥. —Å–æ–¥–µ—Ä–∂–∞—Ç **–∫–ª–∞—Å—Å—ã-–æ–±–µ—Ä—Ç–∫–∏**. –ó–∞–¥–∞—á–∞ —Ç–∞–∫–æ–π –æ–±–µ—Ä—Ç–∫–∏ ‚Äî "–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å" API –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `lightgbm`) –∫ –Ω–∞—à–µ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É `ModelInterface`.

*   `__init__(self, params)`: –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–∑ Hydra-–∫–æ–Ω—Ñ–∏–≥–∞.
*   `fit(...)`: –í—ã–∑—ã–≤–∞–µ—Ç `.fit()` –Ω–∏–∂–µ–ª–µ–∂–∞—â–µ–π –º–æ–¥–µ–ª–∏, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–π –¥–∞–Ω–Ω—ã–µ.
*   `save/load`: –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `joblib` –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–∞-–æ–±–µ—Ä—Ç–∫–∏.

---

## 3. üöÄ –¢—É—Ç–æ—Ä–∏–∞–ª: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ù–æ–≤–æ–π –ú–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ExtraTreesClassifier`)

–ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –∏–∑ `scikit-learn` —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –ø—Ä–æ—Å—Ç –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–∞—à–µ–º—É —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–º—É `SklearnModel`.

**–®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ YAML-–∫–æ–Ω—Ñ–∏–≥**

–í–∞–º **–Ω–µ –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å –Ω–æ–≤—ã–π Python-–∫–æ–¥**. –ü—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª –≤ `conf/model/`, –Ω–∞–ø—Ä–∏–º–µ—Ä `extra_trees.yaml`.

```yaml
# conf/model/extra_trees.yaml

# 1. –£–∫–∞–∑—ã–≤–∞–µ–º Hydra –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π SklearnModel
_target_: ml_foundry.models.sklearn_model.SklearnModel

# 2. –£–∫–∞–∑—ã–≤–∞–µ–º, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ –∫–ª–∞—Å—Å –∏–∑ sklearn –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å
model_class: "sklearn.ensemble.ExtraTreesClassifier"

# 3. –ü–µ—Ä–µ–¥–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ ExtraTreesClassifier
params:
  n_estimators: 1000
  max_depth: 15
  min_samples_leaf: 20
  n_jobs: -1
  random_state: ${globals.seed}
```

**–®–∞–≥ 2: –ì–æ—Ç–æ–≤–æ! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å**

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ —Å –≤–∞—à–µ–π –Ω–æ–≤–æ–π –º–æ–¥–µ–ª—å—é –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
```bash
python src/train.py model=extra_trees
```

---

## 4. üß† –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –¢—É—Ç–æ—Ä–∏–∞–ª: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ú–æ–¥–µ–ª–∏ —Å –£–Ω–∏–∫–∞–ª—å–Ω—ã–º API (–Ω–∞–ø—Ä–∏–º–µ—Ä, PyTorch)

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å, API –∫–æ—Ç–æ—Ä–æ–π —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç `scikit-learn` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–π—Ä–æ—Å–µ—Ç—å –Ω–∞ PyTorch —Å —Ü–∏–∫–ª–æ–º –æ–±—É—á–µ–Ω–∏—è –ø–æ —ç–ø–æ—Ö–∞–º), –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞—Ç—å –¥–ª—è –Ω–µ–µ **—Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å-–æ–±–µ—Ä—Ç–∫—É**.

**–®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `src/models/torch_nn.py`**

**–®–∞–≥ 2: –ù–∞–ø–∏—à–∏—Ç–µ –∫–ª–∞—Å—Å-–æ–±–µ—Ä—Ç–∫—É `TabularNNModel`**

```python
# src/models/torch_nn.py
from .base import ModelInterface

class TabularNNModel(ModelInterface):
    def __init__(self, model_params, training_params, ...):
        # ...
    
    def fit(self, X_train, y_train, **kwargs):
        # ‚ùóÔ∏è –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:
        # 1. –°–æ–∑–¥–∞–Ω–∏–µ Dataset –∏ DataLoader.
        # 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–µ—Ç–∏ (nn.Module).
        # 3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å.
        # 4. –¶–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è –ø–æ —ç–ø–æ—Ö–∞–º –∏ –±–∞—Ç—á–∞–º.
        # 5. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Early Stopping.
        pass

    def predict_proba(self, X):
        # ‚ùóÔ∏è –ó–¥–µ—Å—å –ª–æ–≥–∏–∫–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞:
        # 1. –°–æ–∑–¥–∞–Ω–∏–µ DataLoader –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
        # 2. –¶–∏–∫–ª –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ –±–∞—Ç—á–∞–º.
        # 3. –°–±–æ—Ä –∏ –≤–æ–∑–≤—Ä–∞—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.
        pass
        
    # ... —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã: predict, save, load ...
```

**–®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ YAML-–∫–æ–Ω—Ñ–∏–≥ (`conf/model/torch_nn.yaml`)**
```yaml
_target_: ml_foundry.models.torch_nn.TabularNNModel

model_params:
  layers: [256, 128]
  # ...
training_params:
  epochs: 50
  # ...
```

**–®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ**
```bash
python src/train.py model=torch_nn
```

–≠—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–¥–µ–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –ø—Ä–æ—Å—Ç–æ—Ç–æ–π (–¥–ª—è `sklearn`-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –º–æ–¥–µ–ª–µ–π) –∏ –≥–∏–±–∫–æ—Å—Ç—å—é (–¥–ª—è –º–æ–¥–µ–ª–µ–π —Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–æ–π).